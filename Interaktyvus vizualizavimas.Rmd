---
title: "Interaktyvus duomenų vizualizavimas"
date: "2025-05-09"
output: html_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

Dabar taikome PCA rasti pagrindines komponentes. Rezultatams pavaizduoti naudojame tą patį `splom` brėžinį, tačiau šį kartą kintamieji - gautos pagrindinės komponentės, išrikiuotos pagal tai, kiek dispersijos (variacijos) jos paaiškina.

```{r}

library(stats) #funkcijai prcomp
data(iris)

X <- subset(iris, select = -c(Species))
prin_comp <- prcomp(X)

explained_variance_ratio <- summary(prin_comp)[["importance"]]['Proportion of Variance',]
explained_variance_ratio <- 100 * explained_variance_ratio

components <- prin_comp[["x"]]
components <- data.frame(components)
components <- cbind(components, iris$Species)

components$PC3 <- -components$PC3
components$PC2 <- -components$PC2

fig <- components %>%
  plot_ly()  %>%
  add_trace(
    type = 'splom',
    dimensions = list(
      list(label=paste('PC 1 (',toString(round(explained_variance_ratio[1],1)),'%)',sep = ''), values=~PC1),
      list(label=paste('PC 2 (',toString(round(explained_variance_ratio[2],1)),'%)',sep = ''), values=~PC2),
      list(label=paste('PC 3 (',toString(round(explained_variance_ratio[3],1)),'%)',sep = ''), values=~PC3),
      list(label=paste('PC 4 (',toString(round(explained_variance_ratio[4],1)),'%)',sep = ''), values=~PC4)
    ),
    color = ~iris$Species, colors = c('#636EFA','#EF553B','#00CC96')
  ) %>%
  style(diagonal = list(visible = FALSE)) %>%
  layout(
    legend=list(title=list(text='color')),
    hovermode='closest',
    dragmode= 'select',
    plot_bgcolor='rgba(240,240,240, 0.95)',
    xaxis=list(domain=NULL, showline=F, zeroline=F, 
               gridcolor='#ffffff', ticklen=4),
    yaxis=list(domain=NULL, showline=F, zeroline=F, 
               gridcolor='#ffffff', ticklen=4),
    xaxis2=axis,
    xaxis3=axis,
    xaxis4=axis,
    yaxis2=axis,
    yaxis3=axis,
    yaxis4=axis
  )

fig
```

-   **PC3 ir PC4** grafike matome, kad komponentės nesugeba atskirti klasių – visos rūšys persidengia.

-   **PC1 ir PC2** grafike matome aiškų rūšių atskyrimą.